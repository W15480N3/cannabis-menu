<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SUMMA MENU v2</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        /* BASE THEME */
        html, body { background-color: #000 !important; color: #0f0; font-family: 'Courier New', monospace; margin: 0; padding: 0; }
        
        /* LOADING SCREEN */
        #loader { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #000; z-index: 9999; }
        .bar-container { width: 200px; height: 12px; border: 2px solid #0f0; margin-top: 15px; padding: 2px; }
        #fill { height: 100%; background: #0f0; width: 0%; animation: load 3s forwards; }
        @keyframes load { to { width: 100%; } }

        /* WINAMP WINDOW */
        #app { display: none; width: 96vw; margin: 10px auto; background: #c0c0c0; border: 3px outset #fff; color: #000; box-shadow: 5px 5px 0px #000; }
        .title-bar { background: linear-gradient(90deg, #000080, #0878c0); color: white; padding: 6px; font-weight: bold; font-size: 13px; display: flex; justify-content: space-between; }
        
        /* THE SECRET LOCK */
        #admin-zone { display: none !important; background: #ff4444; padding: 10px; border-bottom: 2px solid #000; text-align: center; }

        #menu-list { background: #000; margin: 4px; border: 2px inset #fff; overflow-y: auto; max-height: 65vh; }
        
        /* COLLAPSIBLE BUTTONS */
        .category-btn { 
            width: 100%; padding: 16px; background: #888; color: #fff; 
            text-align: left; border: 2px outset #eee; font-weight: bold; 
            cursor: pointer; font-size: 16px; text-shadow: 1px 1px #000;
        }
        .category-btn:active { border-style: inset; }

        /* HIDDEN CONTENT BOX */
        .category-content { display: none; background: #111; border-left: 4px solid #0f0; }
        
        .section-header { background: #222; color: #0f0; padding: 10px; font-size: 13px; border-bottom: 1px solid #333; font-weight: bold; }
        .item-row { display: flex; align-items: center; padding: 12px 10px; border-bottom: 1px solid #333; color: #fff; }
        .item-row input { width: 24px; height: 24px; margin-right: 15px; }
        .strain-name { font-weight: bold; font-size: 16px; display: block; }
        .details { color: #0f0; font-size: 12px; }
        
        .footer { padding: 12px; background: #c0c0c0; border-top: 2px solid #888; }
        .order-btn { width: 100%; padding: 18px; background: #0f0; font-weight: bold; border: 3px outset #fff; cursor: pointer; font-size: 16px; }
        .order-btn:active { border-style: inset; background: #00cc00; }
    </style>
</head>
<body>

    <div id="loader">
        <div style="letter-spacing: 4px; font-weight: bold;">INITIALIZING CANNABIS...</div>
        <div class="bar-container"><div id="fill"></div></div>
    </div>

    <div id="app">
        <div id="admin-zone">
            <input type="file" id="excel-upload" accept=".xlsx" style="display:none;">
            <button onclick="document.getElementById('excel-upload').click()" style="padding:10px; font-weight:bold; cursor:pointer;">ðŸ›  ADMIN: UPLOAD menu.xlsx</button>
        </div>

        <div class="title-bar">
            <span>SUMMA_MOBILE_v2.0.exe</span>
            <span>_ â–¡ X</span>
        </div>

        <div id="menu-list">
            </div>

        <div class="footer">
            <button class="order-btn" onclick="sendEmail()">GENERATE ORDER EMAIL</button>
        </div>
    </div>

    <script>
        // NAVIGATION & TOGGLE LOGIC
        function toggleCategory(id) {
            const content = document.getElementById(id);
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        }

        window.onload = () => {
            // Check for Admin Link
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('admin') === 'true') {
                const adminBox = document.getElementById('admin-zone');
                adminBox.style.setProperty("display", "block", "important");
            }

            // Start 3s Loader
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                loadMenuFromFile();
            }, 3000);

            // Manual Upload for Admin
            document.getElementById('excel-upload').addEventListener('change', (e) => {
                const reader = new FileReader();
